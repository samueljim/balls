(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,12024,e=>{"use strict";var t=e.i(17141),s=e.i(44440);function a(e){let[t,a]=(0,s.useState)(WebSocket.CLOSED),[n,r]=(0,s.useState)(null),l=(0,s.useRef)(null),i=(0,s.useCallback)(e=>{let t=l.current;t?.readyState===WebSocket.OPEN&&t.send("string"==typeof e?e:JSON.stringify(e))},[]);return(0,s.useEffect)(()=>{if(!e)return;let t=new WebSocket(e);return l.current=t,t.onopen=()=>a(WebSocket.OPEN),t.onclose=()=>{a(WebSocket.CLOSED),l.current=null},t.onmessage=e=>{try{r(JSON.parse(e.data))}catch{r(e.data)}},()=>{t.close(),l.current=null}},[e]),{readyState:t,lastMessage:n,send:i}}function n(e){let s=(t.default.env.NEXT_PUBLIC_WS_BASE??t.default.env.NEXT_PUBLIC_API_BASE??"https://api.worms.bne.sh").replace(/^http/,"ws");return`${s}${e}`}e.s(["getWsUrl",()=>n,"useWebSocket",()=>a])},83007,e=>{"use strict";var t=e.i(87433),s=e.i(62924),a=e.i(44440),n=e.i(70065),r=e.i(85902),l=e.i(34972),i=e.i(12024);function o({overrideId:e,overrideSearch:c}={}){let d,m=(0,s.useParams)(),u=(0,s.useSearchParams)(),p=void 0!==c?(d=new URLSearchParams(c||window.location.search),{get:e=>d.get(e)}):u,x=e??m.id??"",h="1"===p.get("host"),y=p.get("playerId")??x,g=p.get("playerName")??"Host",[b,f]=(0,a.useState)([]),[S,N]=(0,a.useState)(!1),j=p.get("code")??null;if(!x)return(0,t.jsx)("main",{className:"min-h-screen flex items-center justify-center bg-[#0d1f0d]",children:(0,t.jsx)("p",{className:"text-stone-400",children:"Missing lobby id"})});let C=`/lobby/${x}?playerId=${encodeURIComponent(y)}&playerName=${encodeURIComponent(g)}`,{readyState:B,lastMessage:v,send:I}=(0,i.useWebSocket)((0,i.getWsUrl)(C));(0,a.useEffect)(()=>{if(v&&"object"==typeof v&&("player_list"===v.type&&v.players&&f(v.players),"game_started"===v.type&&v.gameId)){let e=v.playerOrder??[];try{sessionStorage.setItem(`worms:${v.gameId}`,JSON.stringify(e))}catch(e){}window.location.href=`/game/${v.gameId}?playerId=${encodeURIComponent(y)}`}},[v,y]);let P=j?`${window.location.origin}/join/${j}`:"";return(0,t.jsxs)(l.FunPageLayout,{title:"LOBBY",tagline:j?`CODE: ${j}`:void 0,children:[(0,t.jsx)(l.FunPanel,{children:(0,t.jsxs)("div",{className:"space-y-5",children:[B!==WebSocket.OPEN&&(0,t.jsx)("p",{className:"font-display text-sm text-emerald-600/90 tracking-wider",children:"Connectingâ€¦"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-display text-sm text-emerald-600/90 tracking-wider mb-3",children:"PLAYERS"}),(0,t.jsx)("ul",{className:"space-y-2",children:b.map(e=>(0,t.jsxs)("li",{className:"flex items-center justify-between rounded-xl border-2 border-stone-600 bg-stone-950/80 px-4 py-3",children:[(0,t.jsxs)("span",{className:"text-stone-100 font-medium",children:[e.name,e.isBot&&(0,t.jsx)("span",{className:"ml-2 text-xs text-amber-400/90",children:"(bot)"})]}),h&&e.isBot&&(0,t.jsx)(r.Button,{variant:"ghost",onClick:()=>I({type:"remove_bot",playerId:e.id}),className:"text-amber-400 hover:text-amber-300 hover:bg-amber-950/50 rounded-lg px-2 py-1 text-sm",children:"Remove"})]},e.id))})]}),h&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.Button,{variant:"outline",className:l.funButtonSecondaryClass,onClick:()=>I({type:"add_bot"}),children:"ADD BOT"}),P&&(0,t.jsx)(r.Button,{variant:"secondary",className:l.funButtonSecondaryClass,onClick:()=>{P&&(navigator.clipboard.writeText(P),N(!0),setTimeout(()=>N(!1),2e3))},children:S?"COPIED!":"COPY INVITE LINK"}),(0,t.jsx)(r.Button,{className:l.funButtonPrimaryClass,onClick:()=>I({type:"start_game"}),disabled:b.length<2,children:"START GAME"})]})]})}),(0,t.jsx)("p",{className:"mt-8 text-sm text-stone-500",children:(0,t.jsx)(n.default,{href:"/",className:"text-emerald-500 hover:text-emerald-400 underline",children:"Back home"})})]})}e.s(["default",()=>o])},62195,e=>{e.n(e.i(83007))}]);